<!DOCTYPE html>
<html lang="en">
<head>
    <title>Super Secret Agent Stuff</title>
</head>
<body>
    <div id="reimbursement_requests">
        Select the reason for reimbursement:
        <select id="reason">
            <option value="1">Travel</option>
            <option value="2">Ammunition</option>
            <option value="3">Food</option>
            <option value="4">Vetrenarian</option>
            <option value="5">Equipment</option>
        </select>
        <br>
        Enter comment describing the reason:
        <input id="reimbursement_request_comment" size="100">
        <br>
        Enter amount:
        <input id="amount">
        <br>
        <button id="create_request" onclick="createRequest()">Create Request</button>
    </div>
</body>
<script>
    //document.getElementById().getAttribute()
    const employeeId = 2 //document.getElementById("employee").value;
    const tableName =  "reimbursement_requests" //document.getElementById("reimbursement_requests");
    const reasonId = document.getElementById("reason").value;
    const reimbursementRequestComment = document.getElementById("reimbursement_request_comment").value;
    const amount = document.getElementById("amount").value;

    const apiURL = "http://localhost:5000/";

    reimbursmentRequestJSON = {
        'tableName': tableName,
        'employeeId': employeeId,
        'reasonId': reasonId,
        'reimbursementRequestComment': reimbursementRequestComment,
        'amount': amount
    }

    // async useful await keyword
    async function createRequest() {
        alert(reimbursmentRequestJSON.reimbursementRequestComment)
        let sendRequest = {
            method:"POST",
            headers:{'Content-Type':"application/json"},
            body: JSON.stringify(reimbursmentRequestJSON)
        }
        const response = await fetch("http://localhost:5000/", sendRequest);
        if (response.status === 201) {
            const apiResponse = await response.json();
            alert(apiResponse);
        } else if (response.status === 400) { 
            const apiResponse = await response.json();
            alert(apiResponse.message);
            window.location.href = "login.html";
        } else {
            alert("something went wrong?");
        }
    }
</script>
</html>